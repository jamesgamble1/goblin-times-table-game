<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Goblin Times Table Battle</title>
  <style>
    body {
      background: #1c1c1c;
      color: #eee;
      font-family: 'Courier New', Courier, monospace;
      text-align: center;
      padding: 30px;
    }
    .goblin {
      font-size: 24px;
      margin: 20px;
    }
    .goblin img {
      width: 200px;
      height: auto;
    }
    .question {
      font-size: 32px;
      margin: 20px;
    }
    input {
      font-size: 24px;
      padding: 10px;
      width: 100px;
    }
    button {
      font-size: 18px;
      padding: 10px 20px;
      margin-top: 10px;
    }
    .log {
      margin-top: 20px;
      font-size: 16px;
      color: #90ee90;
    }
    .hp-bar {
      margin: 10px;
    }
    .lives {
      font-size: 20px;
      margin-bottom: 10px;
    }
    .version {
      font-size: 14px;
      color: #888;
      margin-bottom: 10px;
    }
  </style>
</head>
<body>
  <h1>üßå Goblin Times Table Battle!</h1>
  <div class="version">Version 2</div>
  <div class="lives" id="playerLives">Your Lives: ‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
  <div class="goblin" id="goblinName">Goblin Appears...</div>
  <div><img id="goblinImage" src="images/goblin1.png" alt="Goblin"></div>
  <div class="hp-bar" id="goblinHp">Goblin HP: ‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
  <div class="question" id="questionText">What's 3 √ó 4?</div>
  <input type="number" id="answer" />
  <br>
  <button onclick="submitAnswer()">Attack!</button>
  <div class="log" id="logText"></div>

  <script>
    const goblinNames = [
      "Grubnose the Gross", "Snaggletooth", "Mathcrusher",
      "Fungus Frank", "Gibble the Gooey", "Wartface",
      "Zog the Slow", "Toadlicker Tim"
    ];

    const goblinImages = [
      "images/goblin1.png", "images/goblin2.png", "images/goblin3.png",
      "images/goblin4.png", "images/goblin5.png", "images/goblin6.png",
      "images/goblin7.png", "images/goblin8.png"
    ];

    const goblinAttacks = [
      "slaps you with a slimy fish üêü",
      "throws mud in your face üí©",
      "screeches and hurts your ears üîä",
      "tickles you mercilessly ü™∂",
      "steals your socks üß¶",
      "burps loudly in your face ü§¢"
    ];

    let goblinHP = 5;
    let playerLives = 3;
    let currentQuestion = {};
    let startTime = 0;
    let timeoutId;

    function randomGoblin() {
      const i = Math.floor(Math.random() * goblinNames.length);
      document.getElementById("goblinImage").src = goblinImages[i];
      return goblinNames[i];
    }

    function randomQuestion() {
      const a = Math.floor(Math.random() * 10) + 1;
      const b = Math.floor(Math.random() * 10) + 1;
      return { a, b, answer: a * b };
    }

    function updateQuestion() {
      clearTimeout(timeoutId);
      currentQuestion = randomQuestion();
      document.getElementById("questionText").textContent =
        `What's ${currentQuestion.a} √ó ${currentQuestion.b}?`;
      document.getElementById("answer").value = '';
      document.getElementById("answer").focus();
      startTime = new Date().getTime();
      timeoutId = setTimeout(() => {
        loseLife("Too slow! The goblin attacks you for waiting too long!");
        updateQuestion();
      }, 20000); // 20 seconds
    }

    function updateGoblin() {
      goblinHP = 5;
      document.getElementById("goblinName").textContent = `${randomGoblin()} appears!`;
      updateHPBar();
      updateQuestion();
      log("A wild goblin appears! Solve fast!");
    }

    function updateHPBar() {
      const hearts = "‚ù§Ô∏è".repeat(goblinHP);
      document.getElementById("goblinHp").textContent = `Goblin HP: ${hearts}`;
    }

    function updateLives() {
      document.getElementById("playerLives").textContent = `Your Lives: ${"‚ù§Ô∏è".repeat(playerLives)}`;
      if (playerLives <= 0) {
        log("Game Over! The goblins have won! üò±");
        document.getElementById("questionText").textContent = "";
        clearTimeout(timeoutId);
        document.querySelector("button").disabled = true;
        document.getElementById("answer").disabled = true;
      }
    }

    function log(text) {
      document.getElementById("logText").textContent = text;
    }

    function loseLife(message) {
      playerLives--;
      updateLives();
      const attack = goblinAttacks[Math.floor(Math.random() * goblinAttacks.length)];
      log(`${message} The goblin ${attack}`);
    }

    function submitAnswer() {
      clearTimeout(timeoutId);
      const userAnswer = parseInt(document.getElementById("answer").value);
      const timeTaken = (new Date().getTime() - startTime) / 1000;

      if (userAnswer === currentQuestion.answer) {
        const bonus = timeTaken < 5 ? 2 : 1;
        goblinHP -= bonus;
        if (goblinHP <= 0) {
          log(`Correct! You defeated the goblin in ${timeTaken.toFixed(2)}s! üéâ`);
          setTimeout(updateGoblin, 2000);
        } else {
          log(`Correct! You hit the goblin for ${bonus} damage.`);
        }
      } else {
        loseLife(`Wrong! The correct answer was ${currentQuestion.answer}.`);
      }

      updateHPBar();
      updateQuestion();
    }

    // Start the game
    updateLives();
    updateGoblin();
  </script>
</body>
</html>
